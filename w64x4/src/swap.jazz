require "bn_generic.jazz"

inline fn swapr(reg ptr u64[nlimbs] x, reg ptr u64[nlimbs] y, reg u64 swap) -> (reg ptr u64[nlimbs] , reg ptr u64[nlimbs]) {

  reg u64 tmp1, tmp2, mask;
  inline int i;

  mask = swap * 0xffffffffffffffff;

  for i = 0 to nlimbs {
   tmp1   = x[i];
   tmp1  ^= y[i];
   tmp1  &= mask;
   x[i]  ^= tmp1;
   tmp2   = y[i];
   tmp2  ^= tmp1;
   y[i] = tmp2;
  }
  return x, y;
}

