require import AllCore IntDiv CoreMap List Distr.
from Jasmin require import JModel.

require import Array32 Array64 Array128 Array256.
require import WArray256 WArray512 WArray1024.



module type Syscall_t = {
  proc randombytes_256(_:W8.t Array256.t) : W8.t Array256.t
}.

module Syscall : Syscall_t = {
  proc randombytes_256(a:W8.t Array256.t) : W8.t Array256.t = {
    a <$ dmap WArray256.darray
         (fun a => Array256.init (fun i => WArray256.get8 a i));
    return a;
  }
}.

module M(SC:Syscall_t) = {
  var leakages : leakages_t
  
  proc bn_subc (a:W64.t Array32.t, b:W64.t Array32.t) : bool *
                                                        W64.t Array32.t = {
    var aux_0: bool;
    var aux_1: int;
    var aux: W64.t;
    
    var cf:bool;
    var x1:W64.t;
    var x2:W64.t;
    var i:int;
    
    leakages <- LeakAddr([0]) :: leakages;
    aux <- a.[0];
    x1 <- aux;
    leakages <- LeakAddr([0]) :: leakages;
    aux <- b.[0];
    x2 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux_0, aux) <- sbb_64 x1 x2 false;
    cf <- aux_0;
    x1 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- x1;
    leakages <- LeakAddr([0]) :: leakages;
    a.[0] <- aux;
    leakages <- LeakFor(1,32) :: LeakAddr([]) :: leakages;
    i <- 1;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux <- a.[i];
      x1 <- aux;
      leakages <- LeakAddr([i]) :: leakages;
      aux <- b.[i];
      x2 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      (aux_0, aux) <- sbb_64 x1 x2 cf;
      cf <- aux_0;
      x1 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- x1;
      leakages <- LeakAddr([i]) :: leakages;
      a.[i] <- aux;
      i <- i + 1;
    }
    return (cf, a);
  }
  
  proc dbn_subc (a:W64.t Array64.t, b:W64.t Array64.t) : bool *
                                                         W64.t Array64.t = {
    var aux_0: bool;
    var aux_1: int;
    var aux: W64.t;
    
    var cf:bool;
    var x1:W64.t;
    var x2:W64.t;
    var i:int;
    
    leakages <- LeakAddr([0]) :: leakages;
    aux <- a.[0];
    x1 <- aux;
    leakages <- LeakAddr([0]) :: leakages;
    aux <- b.[0];
    x2 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux_0, aux) <- sbb_64 x1 x2 false;
    cf <- aux_0;
    x1 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- x1;
    leakages <- LeakAddr([0]) :: leakages;
    a.[0] <- aux;
    leakages <- LeakFor(1,(32 * 2)) :: LeakAddr([]) :: leakages;
    aux_1 <- (32 * 2);
    i <- 1;
    while (i < aux_1) {
      leakages <- LeakAddr([i]) :: leakages;
      aux <- a.[i];
      x1 <- aux;
      leakages <- LeakAddr([i]) :: leakages;
      aux <- b.[i];
      x2 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      (aux_0, aux) <- sbb_64 x1 x2 cf;
      cf <- aux_0;
      x1 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- x1;
      leakages <- LeakAddr([i]) :: leakages;
      a.[i] <- aux;
      i <- i + 1;
    }
    return (cf, a);
  }
  
  proc bn_copy (a:W64.t Array32.t) : W64.t Array32.t = {
    var aux: int;
    var aux_0: W64.t;
    
    var r:W64.t Array32.t;
    var i:int;
    var t:W64.t;
    r <- witness;
    leakages <- LeakFor(0,32) :: LeakAddr([]) :: leakages;
    i <- 0;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux_0 <- a.[i];
      t <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- t;
      leakages <- LeakAddr([i]) :: leakages;
      r.[i] <- aux_0;
      i <- i + 1;
    }
    return (r);
  }
  
  proc dbn_copy (a:W64.t Array64.t) : W64.t Array64.t = {
    var aux: int;
    var aux_0: W64.t;
    
    var r:W64.t Array64.t;
    var i:int;
    var t:W64.t;
    r <- witness;
    leakages <- LeakFor(0,(32 * 2)) :: LeakAddr([]) :: leakages;
    aux <- (32 * 2);
    i <- 0;
    while (i < aux) {
      leakages <- LeakAddr([i]) :: leakages;
      aux_0 <- a.[i];
      t <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- t;
      leakages <- LeakAddr([i]) :: leakages;
      r.[i] <- aux_0;
      i <- i + 1;
    }
    return (r);
  }
  
  proc bn_cmov (cond:bool, a:W64.t Array32.t, b:W64.t Array32.t) : W64.t Array32.t = {
    var aux: int;
    var aux_0: W64.t;
    
    var i:int;
    var r1:W64.t;
    var r2:W64.t;
    
    leakages <- LeakFor(0,32) :: LeakAddr([]) :: leakages;
    i <- 0;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux_0 <- a.[i];
      r1 <- aux_0;
      leakages <- LeakAddr([i]) :: leakages;
      aux_0 <- b.[i];
      r2 <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- (cond ? r2 : r1);
      r1 <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- r1;
      leakages <- LeakAddr([i]) :: leakages;
      a.[i] <- aux_0;
      i <- i + 1;
    }
    return (a);
  }
  
  proc dbn_cmov (cond:bool, a:W64.t Array64.t, b:W64.t Array64.t) : W64.t Array64.t = {
    var aux: int;
    var aux_0: W64.t;
    
    var i:int;
    var r1:W64.t;
    var r2:W64.t;
    
    leakages <- LeakFor(0,(32 * 2)) :: LeakAddr([]) :: leakages;
    aux <- (32 * 2);
    i <- 0;
    while (i < aux) {
      leakages <- LeakAddr([i]) :: leakages;
      aux_0 <- a.[i];
      r1 <- aux_0;
      leakages <- LeakAddr([i]) :: leakages;
      aux_0 <- b.[i];
      r2 <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- (cond ? r2 : r1);
      r1 <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- r1;
      leakages <- LeakAddr([i]) :: leakages;
      a.[i] <- aux_0;
      i <- i + 1;
    }
    return (a);
  }
  
  proc bn_set0 (a:W64.t Array32.t) : W64.t Array32.t = {
    var aux: int;
    var aux_0: W64.t;
    
    var i:int;
    
    leakages <- LeakFor(0,32) :: LeakAddr([]) :: leakages;
    i <- 0;
    while (i < 32) {
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- (W64.of_int 0);
      leakages <- LeakAddr([i]) :: leakages;
      a.[i] <- aux_0;
      i <- i + 1;
    }
    return (a);
  }
  
  proc bn_set1 (a:W64.t Array32.t) : W64.t Array32.t = {
    var aux_0: int;
    var aux: W64.t;
    
    var i:int;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1);
    leakages <- LeakAddr([0]) :: leakages;
    a.[0] <- aux;
    leakages <- LeakFor(1,32) :: LeakAddr([]) :: leakages;
    i <- 1;
    while (i < 32) {
      leakages <- LeakAddr([]) :: leakages;
      aux <- (W64.of_int 0);
      leakages <- LeakAddr([i]) :: leakages;
      a.[i] <- aux;
      i <- i + 1;
    }
    return (a);
  }
  
  proc bn_addc (a:W64.t Array32.t, b:W64.t Array32.t) : bool *
                                                        W64.t Array32.t = {
    var aux_0: bool;
    var aux_1: int;
    var aux: W64.t;
    
    var cf:bool;
    var x1:W64.t;
    var x2:W64.t;
    var i:int;
    
    leakages <- LeakAddr([0]) :: leakages;
    aux <- a.[0];
    x1 <- aux;
    leakages <- LeakAddr([0]) :: leakages;
    aux <- b.[0];
    x2 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux_0, aux) <- adc_64 x1 x2 false;
    cf <- aux_0;
    x1 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- x1;
    leakages <- LeakAddr([0]) :: leakages;
    a.[0] <- aux;
    leakages <- LeakFor(1,32) :: LeakAddr([]) :: leakages;
    i <- 1;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux <- a.[i];
      x1 <- aux;
      leakages <- LeakAddr([i]) :: leakages;
      aux <- b.[i];
      x2 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      (aux_0, aux) <- adc_64 x1 x2 cf;
      cf <- aux_0;
      x1 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- x1;
      leakages <- LeakAddr([i]) :: leakages;
      a.[i] <- aux;
      i <- i + 1;
    }
    return (cf, a);
  }
  
  proc dbn_addc (a:W64.t Array64.t, b:W64.t Array64.t) : bool *
                                                         W64.t Array64.t = {
    var aux_0: bool;
    var aux_1: int;
    var aux: W64.t;
    
    var cf:bool;
    var x1:W64.t;
    var x2:W64.t;
    var i:int;
    
    leakages <- LeakAddr([0]) :: leakages;
    aux <- a.[0];
    x1 <- aux;
    leakages <- LeakAddr([0]) :: leakages;
    aux <- b.[0];
    x2 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux_0, aux) <- adc_64 x1 x2 false;
    cf <- aux_0;
    x1 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- x1;
    leakages <- LeakAddr([0]) :: leakages;
    a.[0] <- aux;
    leakages <- LeakFor(1,(32 * 2)) :: LeakAddr([]) :: leakages;
    aux_1 <- (32 * 2);
    i <- 1;
    while (i < aux_1) {
      leakages <- LeakAddr([i]) :: leakages;
      aux <- a.[i];
      x1 <- aux;
      leakages <- LeakAddr([i]) :: leakages;
      aux <- b.[i];
      x2 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      (aux_0, aux) <- adc_64 x1 x2 cf;
      cf <- aux_0;
      x1 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- x1;
      leakages <- LeakAddr([i]) :: leakages;
      a.[i] <- aux;
      i <- i + 1;
    }
    return (cf, a);
  }
  
  proc mul1 (a:W64.t, b:W64.t Array32.t) : W64.t * bool * bool *
                                           W64.t Array64.t = {
    var aux_3: bool;
    var aux_2: bool;
    var aux_1: bool;
    var aux_0: bool;
    var aux: bool;
    var aux_6: int;
    var aux_5: W64.t;
    var aux_4: W64.t;
    
    var _zero:W64.t;
    var of_0:bool;
    var cf:bool;
    var r:W64.t Array64.t;
    var x1:W64.t;
    var x2:W64.t;
    var i:int;
    var lo:W64.t;
    var  _0:bool;
    var  _1:bool;
    var  _2:bool;
    r <- witness;
    leakages <- LeakAddr([]) :: leakages;
    (aux_3, aux_2, aux_1, aux_0, aux, aux_5) <- set0_64 ;
    of_0 <- aux_3;
    cf <- aux_2;
     _0 <- aux_1;
     _1 <- aux_0;
     _2 <- aux;
    _zero <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    aux_5 <- a;
    x1 <- aux_5;
    leakages <- LeakAddr([0]) :: leakages;
    aux_5 <- b.[0];
    x2 <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    (aux_5, aux_4) <- MULX_64 x1 x2;
    x1 <- aux_5;
    x2 <- aux_4;
    leakages <- LeakAddr([]) :: leakages;
    aux_5 <- x1;
    leakages <- LeakAddr([1]) :: leakages;
    r.[1] <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    aux_5 <- x2;
    leakages <- LeakAddr([0]) :: leakages;
    r.[0] <- aux_5;
    leakages <- LeakFor(1,32) :: LeakAddr([]) :: leakages;
    i <- 1;
    while (i < 32) {
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- a;
      x1 <- aux_5;
      leakages <- LeakAddr([i]) :: leakages;
      aux_5 <- b.[i];
      x2 <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      (aux_5, aux_4) <- MULX_64 x1 x2;
      x1 <- aux_5;
      x2 <- aux_4;
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- x1;
      leakages <- LeakAddr([(i + 1)]) :: leakages;
      r.[(i + 1)] <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- x2;
      lo <- aux_5;
      leakages <- LeakAddr([i]) :: leakages;
      aux_5 <- r.[i];
      x1 <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- lo;
      x2 <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      (aux_3, aux_5) <- ADCX_64 x1 x2 cf;
      cf <- aux_3;
      x1 <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- x1;
      leakages <- LeakAddr([i]) :: leakages;
      r.[i] <- aux_5;
      i <- i + 1;
    }
    leakages <- LeakAddr([32]) :: leakages;
    aux_5 <- r.[32];
    x1 <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    (aux_3, aux_5) <- ADCX_64 x1 _zero cf;
    cf <- aux_3;
    x1 <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    aux_5 <- x1;
    leakages <- LeakAddr([32]) :: leakages;
    r.[32] <- aux_5;
    return (_zero, of_0, cf, r);
  }
  
  proc mul1acc (k:W64.t, a:W64.t, b:W64.t Array32.t, r:W64.t Array64.t,
                _zero:W64.t, of_0:bool, cf:bool) : W64.t * bool * bool *
                                                   W64.t Array64.t = {
    var aux_2: bool;
    var aux: int;
    var aux_1: W64.t;
    var aux_0: W64.t;
    
    var kk:int;
    var x1:W64.t;
    var i:int;
    var x2:W64.t;
    var hi:W64.t;
    var lo:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.to_uint k);
    kk <- aux;
    leakages <- LeakFor(0,(32 - 1)) :: LeakAddr([]) :: leakages;
    aux <- (32 - 1);
    i <- 0;
    while (i < aux) {
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- a;
      x1 <- aux_1;
      leakages <- LeakAddr([i]) :: leakages;
      aux_1 <- b.[i];
      x2 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      (aux_1, aux_0) <- MULX_64 x1 x2;
      x1 <- aux_1;
      x2 <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- x1;
      hi <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- x2;
      lo <- aux_1;
      leakages <- LeakAddr([(kk + i)]) :: leakages;
      aux_1 <- r.[(kk + i)];
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      (aux_2, aux_1) <- ADOX_64 x1 lo of_0;
      of_0 <- aux_2;
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- x1;
      leakages <- LeakAddr([(kk + i)]) :: leakages;
      r.[(kk + i)] <- aux_1;
      leakages <- LeakAddr([((kk + i) + 1)]) :: leakages;
      aux_1 <- r.[((kk + i) + 1)];
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      (aux_2, aux_1) <- ADCX_64 x1 hi cf;
      cf <- aux_2;
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- x1;
      leakages <- LeakAddr([((kk + i) + 1)]) :: leakages;
      r.[((kk + i) + 1)] <- aux_1;
      i <- i + 1;
    }
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- a;
    x1 <- aux_1;
    leakages <- LeakAddr([(32 - 1)]) :: leakages;
    aux_1 <- b.[(32 - 1)];
    x2 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    (aux_1, aux_0) <- MULX_64 x1 x2;
    x1 <- aux_1;
    x2 <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x1;
    leakages <- LeakAddr([(32 + kk)]) :: leakages;
    r.[(32 + kk)] <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x2;
    lo <- aux_1;
    leakages <- LeakAddr([((32 + kk) - 1)]) :: leakages;
    aux_1 <- r.[((32 + kk) - 1)];
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    (aux_2, aux_1) <- ADOX_64 x1 lo of_0;
    of_0 <- aux_2;
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x1;
    leakages <- LeakAddr([((32 + kk) - 1)]) :: leakages;
    r.[((32 + kk) - 1)] <- aux_1;
    leakages <- LeakAddr([(32 + kk)]) :: leakages;
    aux_1 <- r.[(32 + kk)];
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    (aux_2, aux_1) <- ADCX_64 x1 _zero cf;
    cf <- aux_2;
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x1;
    leakages <- LeakAddr([(32 + kk)]) :: leakages;
    r.[(32 + kk)] <- aux_1;
    leakages <- LeakAddr([(32 + kk)]) :: leakages;
    aux_1 <- r.[(32 + kk)];
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    (aux_2, aux_1) <- ADOX_64 x1 _zero of_0;
    of_0 <- aux_2;
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x1;
    leakages <- LeakAddr([(32 + kk)]) :: leakages;
    r.[(32 + kk)] <- aux_1;
    return (_zero, of_0, cf, r);
  }
  
  proc bn_muln (a:W64.t Array32.t, b:W64.t Array32.t) : W64.t * bool * bool *
                                                        W64.t Array64.t = {
    var aux_1: bool;
    var aux_0: bool;
    var aux_3: int;
    var aux: W64.t;
    var aux_2: W64.t Array64.t;
    
    var _zero:W64.t;
    var of_0:bool;
    var cf:bool;
    var r:W64.t Array64.t;
    var ai:W64.t;
    var i:int;
    var z:W64.t;
    r <- witness;
    leakages <- LeakAddr([0]) :: leakages;
    aux <- a.[0];
    ai <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux, aux_1, aux_0, aux_2) <@ mul1 (ai, b);
    _zero <- aux;
    of_0 <- aux_1;
    cf <- aux_0;
    r <- aux_2;
    leakages <- LeakFor(1,32) :: LeakAddr([]) :: leakages;
    i <- 1;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux <- a.[i];
      ai <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- (W64.of_int i);
      z <- aux;
      leakages <- LeakAddr([]) :: leakages;
      (aux, aux_1, aux_0, aux_2) <@ mul1acc (z, ai, b, r, _zero, of_0, cf);
      _zero <- aux;
      of_0 <- aux_1;
      cf <- aux_0;
      r <- aux_2;
      i <- i + 1;
    }
    return (_zero, of_0, cf, r);
  }
  
  proc dmul1 (a:W64.t, b:W64.t Array64.t) : W64.t * bool * bool *
                                            W64.t Array128.t = {
    var aux_3: bool;
    var aux_2: bool;
    var aux_1: bool;
    var aux_0: bool;
    var aux: bool;
    var aux_6: int;
    var aux_5: W64.t;
    var aux_4: W64.t;
    
    var _zero:W64.t;
    var of_0:bool;
    var cf:bool;
    var r:W64.t Array128.t;
    var x1:W64.t;
    var x2:W64.t;
    var i:int;
    var lo:W64.t;
    var  _0:bool;
    var  _1:bool;
    var  _2:bool;
    r <- witness;
    leakages <- LeakAddr([]) :: leakages;
    (aux_3, aux_2, aux_1, aux_0, aux, aux_5) <- set0_64 ;
    of_0 <- aux_3;
    cf <- aux_2;
     _0 <- aux_1;
     _1 <- aux_0;
     _2 <- aux;
    _zero <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    aux_5 <- a;
    x1 <- aux_5;
    leakages <- LeakAddr([0]) :: leakages;
    aux_5 <- b.[0];
    x2 <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    (aux_5, aux_4) <- MULX_64 x1 x2;
    x1 <- aux_5;
    x2 <- aux_4;
    leakages <- LeakAddr([]) :: leakages;
    aux_5 <- x1;
    leakages <- LeakAddr([1]) :: leakages;
    r.[1] <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    aux_5 <- x2;
    leakages <- LeakAddr([0]) :: leakages;
    r.[0] <- aux_5;
    leakages <- LeakFor(1,(32 * 2)) :: LeakAddr([]) :: leakages;
    aux_6 <- (32 * 2);
    i <- 1;
    while (i < aux_6) {
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- a;
      x1 <- aux_5;
      leakages <- LeakAddr([i]) :: leakages;
      aux_5 <- b.[i];
      x2 <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      (aux_5, aux_4) <- MULX_64 x1 x2;
      x1 <- aux_5;
      x2 <- aux_4;
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- x1;
      leakages <- LeakAddr([(i + 1)]) :: leakages;
      r.[(i + 1)] <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- x2;
      lo <- aux_5;
      leakages <- LeakAddr([i]) :: leakages;
      aux_5 <- r.[i];
      x1 <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- lo;
      x2 <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      (aux_3, aux_5) <- ADCX_64 x1 x2 cf;
      cf <- aux_3;
      x1 <- aux_5;
      leakages <- LeakAddr([]) :: leakages;
      aux_5 <- x1;
      leakages <- LeakAddr([i]) :: leakages;
      r.[i] <- aux_5;
      i <- i + 1;
    }
    leakages <- LeakAddr([(32 * 2)]) :: leakages;
    aux_5 <- r.[(32 * 2)];
    x1 <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    (aux_3, aux_5) <- ADCX_64 x1 _zero cf;
    cf <- aux_3;
    x1 <- aux_5;
    leakages <- LeakAddr([]) :: leakages;
    aux_5 <- x1;
    leakages <- LeakAddr([(32 * 2)]) :: leakages;
    r.[(32 * 2)] <- aux_5;
    return (_zero, of_0, cf, r);
  }
  
  proc dmul1acc (k:W64.t, a:W64.t, b:W64.t Array64.t, r:W64.t Array128.t,
                 _zero:W64.t, of_0:bool, cf:bool) : W64.t * bool * bool *
                                                    W64.t Array128.t = {
    var aux_2: bool;
    var aux: int;
    var aux_1: W64.t;
    var aux_0: W64.t;
    
    var kk:int;
    var x1:W64.t;
    var i:int;
    var x2:W64.t;
    var hi:W64.t;
    var lo:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.to_uint k);
    kk <- aux;
    leakages <- LeakFor(0,((32 * 2) - 1)) :: LeakAddr([]) :: leakages;
    aux <- ((32 * 2) - 1);
    i <- 0;
    while (i < aux) {
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- a;
      x1 <- aux_1;
      leakages <- LeakAddr([i]) :: leakages;
      aux_1 <- b.[i];
      x2 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      (aux_1, aux_0) <- MULX_64 x1 x2;
      x1 <- aux_1;
      x2 <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- x1;
      hi <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- x2;
      lo <- aux_1;
      leakages <- LeakAddr([(kk + i)]) :: leakages;
      aux_1 <- r.[(kk + i)];
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      (aux_2, aux_1) <- ADOX_64 x1 lo of_0;
      of_0 <- aux_2;
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- x1;
      leakages <- LeakAddr([(kk + i)]) :: leakages;
      r.[(kk + i)] <- aux_1;
      leakages <- LeakAddr([((kk + i) + 1)]) :: leakages;
      aux_1 <- r.[((kk + i) + 1)];
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      (aux_2, aux_1) <- ADCX_64 x1 hi cf;
      cf <- aux_2;
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <- x1;
      leakages <- LeakAddr([((kk + i) + 1)]) :: leakages;
      r.[((kk + i) + 1)] <- aux_1;
      i <- i + 1;
    }
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- a;
    x1 <- aux_1;
    leakages <- LeakAddr([((32 * 2) - 1)]) :: leakages;
    aux_1 <- b.[((32 * 2) - 1)];
    x2 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    (aux_1, aux_0) <- MULX_64 x1 x2;
    x1 <- aux_1;
    x2 <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x1;
    leakages <- LeakAddr([((32 * 2) + kk)]) :: leakages;
    r.[((32 * 2) + kk)] <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x2;
    lo <- aux_1;
    leakages <- LeakAddr([(((32 * 2) + kk) - 1)]) :: leakages;
    aux_1 <- r.[(((32 * 2) + kk) - 1)];
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    (aux_2, aux_1) <- ADOX_64 x1 lo of_0;
    of_0 <- aux_2;
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x1;
    leakages <- LeakAddr([(((32 * 2) + kk) - 1)]) :: leakages;
    r.[(((32 * 2) + kk) - 1)] <- aux_1;
    leakages <- LeakAddr([((32 * 2) + kk)]) :: leakages;
    aux_1 <- r.[((32 * 2) + kk)];
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    (aux_2, aux_1) <- ADCX_64 x1 _zero cf;
    cf <- aux_2;
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x1;
    leakages <- LeakAddr([((32 * 2) + kk)]) :: leakages;
    r.[((32 * 2) + kk)] <- aux_1;
    leakages <- LeakAddr([((32 * 2) + kk)]) :: leakages;
    aux_1 <- r.[((32 * 2) + kk)];
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    (aux_2, aux_1) <- ADOX_64 x1 _zero of_0;
    of_0 <- aux_2;
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- x1;
    leakages <- LeakAddr([((32 * 2) + kk)]) :: leakages;
    r.[((32 * 2) + kk)] <- aux_1;
    return (_zero, of_0, cf, r);
  }
  
  proc dbn_muln (a:W64.t Array64.t, b:W64.t Array64.t) : W64.t * bool *
                                                         bool *
                                                         W64.t Array128.t = {
    var aux_1: bool;
    var aux_0: bool;
    var aux_3: int;
    var aux: W64.t;
    var aux_2: W64.t Array128.t;
    
    var _zero:W64.t;
    var of_0:bool;
    var cf:bool;
    var r:W64.t Array128.t;
    var ai:W64.t;
    var i:int;
    var z:W64.t;
    r <- witness;
    leakages <- LeakAddr([0]) :: leakages;
    aux <- a.[0];
    ai <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux, aux_1, aux_0, aux_2) <@ dmul1 (ai, b);
    _zero <- aux;
    of_0 <- aux_1;
    cf <- aux_0;
    r <- aux_2;
    leakages <- LeakFor(1,(32 * 2)) :: LeakAddr([]) :: leakages;
    aux_3 <- (32 * 2);
    i <- 1;
    while (i < aux_3) {
      leakages <- LeakAddr([i]) :: leakages;
      aux <- a.[i];
      ai <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- (W64.of_int i);
      z <- aux;
      leakages <- LeakAddr([]) :: leakages;
      (aux, aux_1, aux_0, aux_2) <@ dmul1acc (z, ai, b, r, _zero, of_0, cf);
      _zero <- aux;
      of_0 <- aux_1;
      cf <- aux_0;
      r <- aux_2;
      i <- i + 1;
    }
    return (_zero, of_0, cf, r);
  }
  
  proc rsample (byte_z:W64.t Array32.t) : int * W64.t Array32.t = {
    var aux_5: bool;
    var aux_4: bool;
    var aux_3: bool;
    var aux_2: bool;
    var aux_1: bool;
    var aux: int;
    var aux_6: W64.t;
    var aux_7: W8.t Array256.t;
    var aux_0: W64.t Array32.t;
    
    var i:int;
    var byte_p:W64.t Array32.t;
    var cf:bool;
    var byte_q:W64.t Array32.t;
    var  _0:bool;
    var  _1:bool;
    var  _2:bool;
    var  _3:bool;
    var  _4:W64.t;
    byte_p <- witness;
    byte_q <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <- 0;
    i <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ bn_set0 (byte_p);
    byte_p <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    (aux_5, aux_4, aux_3, aux_2, aux_1, aux_6) <- set0_64 ;
     _0 <- aux_5;
    cf <- aux_4;
     _1 <- aux_3;
     _2 <- aux_2;
     _3 <- aux_1;
     _4 <- aux_6;
    
    leakages <- LeakCond((! cf)) :: LeakAddr([]) :: leakages;
    
    while ((! cf)) {
      leakages <- LeakAddr([]) :: leakages;
      aux_7 <@ SC.randombytes_256 ((Array256.init (fun i_0 => get8
                                   (WArray256.init64 (fun i_0 => byte_p.[i_0]))
                                   i_0)));
      byte_p <-
      (Array32.init (fun i_0 => get64
      (WArray256.init8 (fun i_0 => aux_7.[i_0])) i_0));
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <@ bn_copy (byte_p);
      byte_q <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      (aux_5, aux_0) <@ bn_subc (byte_q, byte_z);
      cf <- aux_5;
      byte_q <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux <- (i + 1);
      i <- aux;
    leakages <- LeakCond((! cf)) :: LeakAddr([]) :: leakages;
    
    }
    return (i, byte_p);
  }
  
  proc ith_bit64 (k:W64.t, ctr:W64.t) : W64.t = {
    var aux: W64.t;
    
    var bit:W64.t;
    var p:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- k;
    bit <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- ctr;
    p <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (p `&` (W64.of_int 63));
    p <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (bit `>>` (truncateu8 p));
    bit <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (bit `&` (W64.of_int 1));
    bit <- aux;
    return (bit);
  }
  
  proc ith_bit (kk:W64.t Array32.t, ctr:W64.t) : W64.t = {
    var aux: W64.t;
    
    var bit:W64.t;
    var ctr2:W64.t;
    var ctr3:W64.t;
    var c1:W64.t;
    var c2:W64.t;
    var r:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- ctr;
    ctr2 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- ctr;
    ctr3 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (ctr2 `>>` (W8.of_int 6));
    c1 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (ctr3 `&` (W64.of_int 63));
    c2 <- aux;
    leakages <- LeakAddr([(W64.to_uint c1)]) :: leakages;
    aux <- kk.[(W64.to_uint c1)];
    r <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ ith_bit64 (r, c2);
    bit <- aux;
    return (bit);
  }
  
  proc swapr (x:W64.t Array32.t, y:W64.t Array32.t, swap_0:W64.t) : W64.t Array32.t *
                                                                    W64.t Array32.t = {
    var aux_0: int;
    var aux: W64.t;
    
    var mask:W64.t;
    var i:int;
    var tmp1:W64.t;
    var tmp2:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (swap_0 * (W64.of_int 18446744073709551615));
    mask <- aux;
    leakages <- LeakFor(0,32) :: LeakAddr([]) :: leakages;
    i <- 0;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux <- x.[i];
      tmp1 <- aux;
      leakages <- LeakAddr([i]) :: leakages;
      aux <- (tmp1 `^` y.[i]);
      tmp1 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- (tmp1 `&` mask);
      tmp1 <- aux;
      leakages <- LeakAddr([i]) :: leakages;
      aux <- (x.[i] `^` tmp1);
      leakages <- LeakAddr([i]) :: leakages;
      x.[i] <- aux;
      leakages <- LeakAddr([i]) :: leakages;
      aux <- y.[i];
      tmp2 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- (tmp2 `^` tmp1);
      tmp2 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- tmp2;
      leakages <- LeakAddr([i]) :: leakages;
      y.[i] <- aux;
      i <- i + 1;
    }
    return (x, y);
  }
  
  proc sn_cmov (cond:bool, a:W64.t, b:W64.t) : W64.t = {
    var aux: W64.t;
    
    var r1:W64.t;
    var r2:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- a;
    r1 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- b;
    r2 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (cond ? r2 : r1);
    r1 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- r1;
    a <- aux;
    return (a);
  }
  
  proc bn_eq (a:W64.t Array32.t, b:W64.t Array32.t) : W64.t = {
    var aux_1: bool;
    var aux_0: int;
    var aux: W64.t;
    
    var output:W64.t;
    var result:W64.t;
    var i:int;
    var c1:W64.t;
    var c2:W64.t;
    var cf:bool;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    result <- aux;
    leakages <- LeakFor(0,32) :: LeakAddr([]) :: leakages;
    i <- 0;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux <- a.[i];
      c1 <- aux;
      leakages <- LeakAddr([i]) :: leakages;
      aux <- b.[i];
      c2 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- (c1 `^` c2);
      c1 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux <- (result `|` c1);
      result <- aux;
      i <- i + 1;
    }
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- (result = (W64.of_int 0));
    cf <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ sn_cmov (cf, (W64.of_int 0), (W64.of_int 1));
    output <- aux;
    return (output);
  }
  
  proc cminusP (p:W64.t Array32.t, x:W64.t Array32.t) : W64.t Array32.t = {
    var aux_0: bool;
    var aux: W64.t Array32.t;
    
    var z:W64.t Array32.t;
    var cf:bool;
    z <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_copy (x);
    z <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux_0, aux) <@ bn_subc (z, p);
    cf <- aux_0;
    z <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_cmov (cf, z, x);
    x <- aux;
    return (x);
  }
  
  proc dcminusP (p:W64.t Array64.t, x:W64.t Array64.t) : W64.t Array64.t = {
    var aux_0: bool;
    var aux: W64.t Array64.t;
    
    var z:W64.t Array64.t;
    var cf:bool;
    z <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ dbn_copy (x);
    z <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux_0, aux) <@ dbn_subc (z, p);
    cf <- aux_0;
    z <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ dbn_cmov (cf, z, x);
    x <- aux;
    return (x);
  }
  
  proc daddm (p:W64.t Array64.t, a:W64.t Array64.t, b:W64.t Array64.t) : 
  W64.t Array64.t = {
    var aux: bool;
    var aux_0: W64.t Array64.t;
    
    var  _0:bool;
    
    leakages <- LeakAddr([]) :: leakages;
    (aux, aux_0) <@ dbn_addc (a, b);
     _0 <- aux;
    a <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ dcminusP (p, a);
    a <- aux_0;
    return (a);
  }
  
  proc bn_expand (x:W64.t Array32.t) : W64.t Array64.t = {
    var aux: int;
    var aux_0: W64.t;
    
    var r:W64.t Array64.t;
    var i:int;
    r <- witness;
    leakages <- LeakFor(0,32) :: LeakAddr([]) :: leakages;
    i <- 0;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux_0 <- x.[i];
      leakages <- LeakAddr([i]) :: leakages;
      r.[i] <- aux_0;
      i <- i + 1;
    }
    leakages <- LeakFor(32,(32 * 2)) :: LeakAddr([]) :: leakages;
    aux <- (32 * 2);
    i <- 32;
    while (i < aux) {
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- (W64.of_int 0);
      leakages <- LeakAddr([i]) :: leakages;
      r.[i] <- aux_0;
      i <- i + 1;
    }
    return (r);
  }
  
  proc addm (p:W64.t Array32.t, a:W64.t Array32.t, b:W64.t Array32.t) : 
  W64.t Array32.t = {
    var aux: bool;
    var aux_0: W64.t Array32.t;
    
    var  _0:bool;
    
    leakages <- LeakAddr([]) :: leakages;
    (aux, aux_0) <@ bn_addc (a, b);
     _0 <- aux;
    a <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ cminusP (p, a);
    a <- aux_0;
    return (a);
  }
  
  proc bn_shrink (x:W64.t Array64.t) : W64.t Array32.t = {
    var aux: int;
    var aux_0: W64.t;
    
    var r:W64.t Array32.t;
    var i:int;
    r <- witness;
    leakages <- LeakFor(0,32) :: LeakAddr([]) :: leakages;
    i <- 0;
    while (i < 32) {
      leakages <- LeakAddr([i]) :: leakages;
      aux_0 <- x.[i];
      leakages <- LeakAddr([i]) :: leakages;
      r.[i] <- aux_0;
      i <- i + 1;
    }
    return (r);
  }
  
  proc addm2 (p:W64.t Array32.t, a:W64.t Array32.t, b:W64.t Array32.t) : 
  W64.t Array32.t = {
    var aux_0: W64.t Array32.t;
    var aux: W64.t Array64.t;
    
    var d:W64.t Array32.t;
    var aa:W64.t Array64.t;
    var bb:W64.t Array64.t;
    var pp:W64.t Array64.t;
    var cc:W64.t Array64.t;
    aa <- witness;
    bb <- witness;
    cc <- witness;
    d <- witness;
    pp <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_expand (a);
    aa <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_expand (b);
    bb <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_expand (p);
    pp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ daddm (pp, aa, bb);
    cc <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ bn_shrink (cc);
    d <- aux_0;
    return (d);
  }
  
  proc div2 (x:W64.t Array128.t, k:int) : W64.t Array64.t = {
    var aux: int;
    var aux_0: W64.t;
    
    var r:W64.t Array64.t;
    var i:int;
    r <- witness;
    leakages <- LeakFor(0,k) :: LeakAddr([]) :: leakages;
    aux <- k;
    i <- 0;
    while (i < aux) {
      leakages <- LeakAddr([((32 * 2) + i)]) :: leakages;
      aux_0 <- x.[((32 * 2) + i)];
      leakages <- LeakAddr([i]) :: leakages;
      r.[i] <- aux_0;
      i <- i + 1;
    }
    return (r);
  }
  
  proc bn_breduce (a:W64.t Array64.t, r:W64.t Array64.t, p:W64.t Array32.t) : 
  W64.t Array32.t = {
    var aux_1: bool;
    var aux_0: bool;
    var aux: W64.t;
    var aux_4: W64.t Array32.t;
    var aux_3: W64.t Array64.t;
    var aux_2: W64.t Array128.t;
    
    var res_0:W64.t Array32.t;
    var xr:W64.t Array128.t;
    var xrf:W64.t Array64.t;
    var xrfd:W64.t Array32.t;
    var xrfn:W64.t Array64.t;
    var t:W64.t Array64.t;
    var pp:W64.t Array64.t;
    var  _0:W64.t;
    var  _1:bool;
    var  _2:bool;
    var  _3:W64.t;
    var  _4:bool;
    var  _5:bool;
    var  _6:bool;
    pp <- witness;
    res_0 <- witness;
    t <- witness;
    xr <- witness;
    xrf <- witness;
    xrfd <- witness;
    xrfn <- witness;
    leakages <- LeakAddr([]) :: leakages;
    (aux, aux_1, aux_0, aux_2) <@ dbn_muln (a, r);
     _0 <- aux;
     _1 <- aux_1;
     _2 <- aux_0;
    xr <- aux_2;
    leakages <- LeakAddr([]) :: leakages;
    aux_3 <@ div2 (xr, (2 * 32));
    xrf <- aux_3;
    leakages <- LeakAddr([]) :: leakages;
    aux_4 <@ bn_shrink (xrf);
    xrfd <- aux_4;
    leakages <- LeakAddr([]) :: leakages;
    (aux, aux_1, aux_0, aux_3) <@ bn_muln (xrfd, p);
     _3 <- aux;
     _4 <- aux_1;
     _5 <- aux_0;
    xrfn <- aux_3;
    leakages <- LeakAddr([]) :: leakages;
    (aux_1, aux_3) <@ dbn_subc (a, xrfn);
     _6 <- aux_1;
    t <- aux_3;
    leakages <- LeakAddr([]) :: leakages;
    aux_3 <@ bn_expand (p);
    pp <- aux_3;
    leakages <- LeakAddr([]) :: leakages;
    aux_3 <@ dcminusP (pp, t);
    t <- aux_3;
    leakages <- LeakAddr([]) :: leakages;
    aux_4 <@ bn_shrink (t);
    res_0 <- aux_4;
    return (res_0);
  }
  
  proc bn_breduce_small (a:W64.t Array32.t, r:W64.t Array64.t,
                         p:W64.t Array32.t) : W64.t Array32.t = {
    var aux_0: W64.t Array32.t;
    var aux: W64.t Array64.t;
    
    var res_0:W64.t Array32.t;
    var aa:W64.t Array64.t;
    aa <- witness;
    res_0 <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_expand (a);
    aa <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ bn_breduce (aa, r, p);
    res_0 <- aux_0;
    return (res_0);
  }
  
  proc mulm (r:W64.t Array64.t, p:W64.t Array32.t, a:W64.t Array32.t,
             b:W64.t Array32.t) : W64.t Array32.t = {
    var aux_1: bool;
    var aux_0: bool;
    var aux: W64.t;
    var aux_3: W64.t Array32.t;
    var aux_2: W64.t Array64.t;
    
    var _of:bool;
    var _cf:bool;
    var c:W64.t Array64.t;
    var  _0:W64.t;
    c <- witness;
    leakages <- LeakAddr([]) :: leakages;
    (aux, aux_1, aux_0, aux_2) <@ bn_muln (a, b);
     _0 <- aux;
    _of <- aux_1;
    _cf <- aux_0;
    c <- aux_2;
    leakages <- LeakAddr([]) :: leakages;
    aux_3 <@ bn_breduce (c, r, p);
    a <- aux_3;
    return (a);
  }
  
  proc expm (r:W64.t Array64.t, m:W64.t Array32.t, x:W64.t Array32.t,
             n:W64.t Array32.t) : W64.t Array32.t = {
    var aux_0: W64.t;
    var aux_1: W64.t Array32.t;
    var aux: W64.t Array32.t;
    
    var x1:W64.t Array32.t;
    var x2:W64.t Array32.t;
    var x11:W64.t Array32.t;
    var i:W64.t;
    var b:W64.t;
    x1 <- witness;
    x11 <- witness;
    x2 <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <@ bn_set1 (x1);
    x1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <@ bn_copy (x);
    x2 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <@ bn_copy (x1);
    x11 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (W64.of_int (32 * 64));
    i <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <- (W64.of_int 0);
    b <- aux_0;
    
    leakages <- LeakCond(((W64.of_int 0) \ult i)) :: LeakAddr([]) :: leakages;
    
    while (((W64.of_int 0) \ult i)) {
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <- (i - (W64.of_int 1));
      i <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      aux_0 <@ ith_bit (n, i);
      b <- aux_0;
      leakages <- LeakAddr([]) :: leakages;
      (aux_1, aux) <@ swapr (x1, x2, b);
      x1 <- aux_1;
      x2 <- aux;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <@ bn_copy (x1);
      x11 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <@ mulm (r, m, x1, x1);
      x1 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      aux_1 <@ mulm (r, m, x11, x2);
      x2 <- aux_1;
      leakages <- LeakAddr([]) :: leakages;
      (aux_1, aux) <@ swapr (x1, x2, b);
      x1 <- aux_1;
      x2 <- aux;
    leakages <- LeakCond(((W64.of_int 0) \ult i)) :: LeakAddr([]) :: leakages;
    
    }
    return (x1);
  }
  
  proc bn_set_p (p:W64.t Array32.t) : W64.t Array32.t = {
    var aux: W64.t;
    
    var tmp:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 18446744073709551615);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([0]) :: leakages;
    p.[0] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1545454141666273896);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([1]) :: leakages;
    p.[1] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1572361106993317136);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([2]) :: leakages;
    p.[2] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 4149303432552213221);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([3]) :: leakages;
    p.[3] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16009113560346531608);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([4]) :: leakages;
    p.[4] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13097978378517762761);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([5]) :: leakages;
    p.[5] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 11180049335738409615);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([6]) :: leakages;
    p.[6] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16401677924195796483);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([7]) :: leakages;
    p.[7] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3643515754058796603);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([8]) :: leakages;
    p.[8] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17398650045445185916);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([9]) :: leakages;
    p.[9] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 7425368496004700164);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([10]) :: leakages;
    p.[10] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 11445099139962410605);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([11]) :: leakages;
    p.[11] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2045464732017971899);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([12]) :: leakages;
    p.[12] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9468076200223288726);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([13]) :: leakages;
    p.[13] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 7572309818504171359);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([14]) :: leakages;
    p.[14] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 11014195235928789914);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([15]) :: leakages;
    p.[15] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13979310375781515013);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([16]) :: leakages;
    p.[16] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5271575865889938237);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([17]) :: leakages;
    p.[17] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12582815541414797286);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([18]) :: leakages;
    p.[18] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17165588707022577573);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([19]) :: leakages;
    p.[19] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 864511594326308845);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([20]) :: leakages;
    p.[20] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17603518614767922539);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([21]) :: leakages;
    p.[21] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16466767132611215046);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([22]) :: leakages;
    p.[22] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5755940542857986629);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([23]) :: leakages;
    p.[23] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3470879405153129527);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([24]) :: leakages;
    p.[24] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17263733006627652379);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([25]) :: leakages;
    p.[25] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5857503583518590173);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([26]) :: leakages;
    p.[26] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 147421033984662306);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([27]) :: leakages;
    p.[27] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2955010104097229940);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([28]) :: leakages;
    p.[28] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14179128828124470481);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([29]) :: leakages;
    p.[29] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14488038916154245684);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([30]) :: leakages;
    p.[30] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 18446744073709551615);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([31]) :: leakages;
    p.[31] <- aux;
    return (p);
  }
  
  proc bn_set_q (q:W64.t Array32.t) : W64.t Array32.t = {
    var aux: W64.t;
    
    var tmp:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9223372036854775807);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([0]) :: leakages;
    q.[0] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 772727070833136948);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([1]) :: leakages;
    q.[1] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10009552590351434376);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([2]) :: leakages;
    q.[2] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2074651716276106610);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([3]) :: leakages;
    q.[3] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17227928817028041612);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([4]) :: leakages;
    q.[4] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15772361226113657188);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([5]) :: leakages;
    q.[5] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14813396704723980615);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([6]) :: leakages;
    q.[6] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17424210998952674049);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([7]) :: leakages;
    q.[7] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1821757877029398301);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([8]) :: leakages;
    q.[8] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8699325022722592958);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([9]) :: leakages;
    q.[9] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12936056284857125890);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([10]) :: leakages;
    q.[10] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14945921606835981110);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([11]) :: leakages;
    q.[11] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1022732366008985949);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([12]) :: leakages;
    q.[12] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13957410136966420171);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([13]) :: leakages;
    q.[13] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3786154909252085679);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([14]) :: leakages;
    q.[14] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14730469654819170765);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([15]) :: leakages;
    q.[15] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16213027224745533314);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([16]) :: leakages;
    q.[16] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2635787932944969118);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([17]) :: leakages;
    q.[17] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15514779807562174451);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([18]) :: leakages;
    q.[18] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17806166390366064594);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([19]) :: leakages;
    q.[19] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9655627834017930230);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([20]) :: leakages;
    q.[20] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8801759307383961269);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([21]) :: leakages;
    q.[21] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17456755603160383331);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([22]) :: leakages;
    q.[22] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12101342308283769122);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([23]) :: leakages;
    q.[23] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10958811739431340571);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([24]) :: leakages;
    q.[24] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17855238540168601997);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([25]) :: leakages;
    q.[25] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2928751791759295086);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([26]) :: leakages;
    q.[26] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 73710516992331153);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([27]) :: leakages;
    q.[27] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10700877088903390778);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([28]) :: leakages;
    q.[28] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 7089564414062235240);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([29]) :: leakages;
    q.[29] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16467391494931898650);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([30]) :: leakages;
    q.[30] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9223372036854775807);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([31]) :: leakages;
    q.[31] <- aux;
    return (q);
  }
  
  proc bn_set_g (g:W64.t Array32.t) : W64.t Array32.t = {
    var aux: W64.t;
    
    var tmp:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([0]) :: leakages;
    g.[0] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([1]) :: leakages;
    g.[1] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([2]) :: leakages;
    g.[2] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([3]) :: leakages;
    g.[3] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([4]) :: leakages;
    g.[4] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([5]) :: leakages;
    g.[5] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([6]) :: leakages;
    g.[6] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([7]) :: leakages;
    g.[7] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([8]) :: leakages;
    g.[8] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([9]) :: leakages;
    g.[9] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([10]) :: leakages;
    g.[10] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([11]) :: leakages;
    g.[11] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([12]) :: leakages;
    g.[12] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([13]) :: leakages;
    g.[13] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([14]) :: leakages;
    g.[14] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([15]) :: leakages;
    g.[15] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([16]) :: leakages;
    g.[16] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([17]) :: leakages;
    g.[17] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([18]) :: leakages;
    g.[18] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([19]) :: leakages;
    g.[19] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([20]) :: leakages;
    g.[20] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([21]) :: leakages;
    g.[21] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([22]) :: leakages;
    g.[22] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([23]) :: leakages;
    g.[23] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([24]) :: leakages;
    g.[24] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([25]) :: leakages;
    g.[25] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([26]) :: leakages;
    g.[26] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([27]) :: leakages;
    g.[27] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([28]) :: leakages;
    g.[28] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([29]) :: leakages;
    g.[29] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([30]) :: leakages;
    g.[30] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([31]) :: leakages;
    g.[31] <- aux;
    return (g);
  }
  
  proc bn_set_bp (bp:W64.t Array64.t) : W64.t Array64.t = {
    var aux: W64.t;
    
    var tmp:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5147934117528057444);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([0]) :: leakages;
    bp.[0] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10407519109700454935);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([1]) :: leakages;
    bp.[1] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16583539182667929086);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([2]) :: leakages;
    bp.[2] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1492440688257385106);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([3]) :: leakages;
    bp.[3] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10066832793016919264);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([4]) :: leakages;
    bp.[4] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 11339370997029172680);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([5]) :: leakages;
    bp.[5] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 4675869585930362320);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([6]) :: leakages;
    bp.[6] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16918262430485393797);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([7]) :: leakages;
    bp.[7] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13728506818757698388);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([8]) :: leakages;
    bp.[8] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13772906965603576095);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([9]) :: leakages;
    bp.[9] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3156528908874584491);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([10]) :: leakages;
    bp.[10] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1231154113365505725);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([11]) :: leakages;
    bp.[11] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17718551243857757924);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([12]) :: leakages;
    bp.[12] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16667871902385732453);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([13]) :: leakages;
    bp.[13] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8054682061035653787);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([14]) :: leakages;
    bp.[14] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12145378267626961546);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([15]) :: leakages;
    bp.[15] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14175206944198899882);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([16]) :: leakages;
    bp.[16] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1872412834642272634);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([17]) :: leakages;
    bp.[17] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10293871819984421175);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([18]) :: leakages;
    bp.[18] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8837694422794646872);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([19]) :: leakages;
    bp.[19] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9711310516503218385);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([20]) :: leakages;
    bp.[20] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 6633261091277544380);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([21]) :: leakages;
    bp.[21] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 6086011487233213371);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([22]) :: leakages;
    bp.[22] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14468328207451868826);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([23]) :: leakages;
    bp.[23] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15312291203922875661);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([24]) :: leakages;
    bp.[24] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10847478293144797667);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([25]) :: leakages;
    bp.[25] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12824558171927804903);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([26]) :: leakages;
    bp.[26] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 7264247675481435729);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([27]) :: leakages;
    bp.[27] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12023220503046567441);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([28]) :: leakages;
    bp.[28] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5117160642964443543);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([29]) :: leakages;
    bp.[29] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3958705157555305931);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([30]) :: leakages;
    bp.[30] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([31]) :: leakages;
    bp.[31] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([32]) :: leakages;
    bp.[32] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([33]) :: leakages;
    bp.[33] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([34]) :: leakages;
    bp.[34] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([35]) :: leakages;
    bp.[35] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([36]) :: leakages;
    bp.[36] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([37]) :: leakages;
    bp.[37] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([38]) :: leakages;
    bp.[38] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([39]) :: leakages;
    bp.[39] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([40]) :: leakages;
    bp.[40] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([41]) :: leakages;
    bp.[41] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([42]) :: leakages;
    bp.[42] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([43]) :: leakages;
    bp.[43] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([44]) :: leakages;
    bp.[44] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([45]) :: leakages;
    bp.[45] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([46]) :: leakages;
    bp.[46] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([47]) :: leakages;
    bp.[47] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([48]) :: leakages;
    bp.[48] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([49]) :: leakages;
    bp.[49] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([50]) :: leakages;
    bp.[50] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([51]) :: leakages;
    bp.[51] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([52]) :: leakages;
    bp.[52] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([53]) :: leakages;
    bp.[53] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([54]) :: leakages;
    bp.[54] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([55]) :: leakages;
    bp.[55] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([56]) :: leakages;
    bp.[56] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([57]) :: leakages;
    bp.[57] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([58]) :: leakages;
    bp.[58] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([59]) :: leakages;
    bp.[59] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([60]) :: leakages;
    bp.[60] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([61]) :: leakages;
    bp.[61] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([62]) :: leakages;
    bp.[62] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([63]) :: leakages;
    bp.[63] <- aux;
    return (bp);
  }
  
  proc bn_set_bq (bq:W64.t Array64.t) : W64.t Array64.t = {
    var aux: W64.t;
    
    var tmp:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10295868235056114890);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([0]) :: leakages;
    bq.[0] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2368294145691358254);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([1]) :: leakages;
    bq.[1] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14720334291626306557);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([2]) :: leakages;
    bq.[2] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2984881376514770213);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([3]) :: leakages;
    bq.[3] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1686921512324286912);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([4]) :: leakages;
    bq.[4] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 4231997920348793745);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([5]) :: leakages;
    bq.[5] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9351739171860724641);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([6]) :: leakages;
    bq.[6] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15389780787261235978);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([7]) :: leakages;
    bq.[7] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9010269563805845161);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([8]) :: leakages;
    bq.[8] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9099069857497600575);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([9]) :: leakages;
    bq.[9] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 6313057817749168983);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([10]) :: leakages;
    bq.[10] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2462308226731011450);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([11]) :: leakages;
    bq.[11] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16990358414005964232);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([12]) :: leakages;
    bq.[12] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14888999731061913291);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([13]) :: leakages;
    bq.[13] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16109364122071307575);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([14]) :: leakages;
    bq.[14] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5844012461544371476);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([15]) :: leakages;
    bq.[15] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9903669814688248149);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([16]) :: leakages;
    bq.[16] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3744825669284545269);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([17]) :: leakages;
    bq.[17] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2140999566259290734);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([18]) :: leakages;
    bq.[18] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17675388845589293745);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([19]) :: leakages;
    bq.[19] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 975876959296885154);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([20]) :: leakages;
    bq.[20] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13266522182555088761);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([21]) :: leakages;
    bq.[21] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12172022974466426742);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([22]) :: leakages;
    bq.[22] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10489912341194186036);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([23]) :: leakages;
    bq.[23] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12177838334136199707);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([24]) :: leakages;
    bq.[24] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3248212512580043719);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([25]) :: leakages;
    bq.[25] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 7202372270146058191);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([26]) :: leakages;
    bq.[26] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14528495350962871459);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([27]) :: leakages;
    bq.[27] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5599696932383583266);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([28]) :: leakages;
    bq.[28] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10234321285928887087);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([29]) :: leakages;
    bq.[29] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 7917410315110611862);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([30]) :: leakages;
    bq.[30] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([31]) :: leakages;
    bq.[31] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([32]) :: leakages;
    bq.[32] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([33]) :: leakages;
    bq.[33] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([34]) :: leakages;
    bq.[34] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([35]) :: leakages;
    bq.[35] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([36]) :: leakages;
    bq.[36] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([37]) :: leakages;
    bq.[37] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([38]) :: leakages;
    bq.[38] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([39]) :: leakages;
    bq.[39] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([40]) :: leakages;
    bq.[40] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([41]) :: leakages;
    bq.[41] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([42]) :: leakages;
    bq.[42] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([43]) :: leakages;
    bq.[43] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([44]) :: leakages;
    bq.[44] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([45]) :: leakages;
    bq.[45] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([46]) :: leakages;
    bq.[46] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([47]) :: leakages;
    bq.[47] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([48]) :: leakages;
    bq.[48] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([49]) :: leakages;
    bq.[49] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([50]) :: leakages;
    bq.[50] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([51]) :: leakages;
    bq.[51] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([52]) :: leakages;
    bq.[52] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([53]) :: leakages;
    bq.[53] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([54]) :: leakages;
    bq.[54] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([55]) :: leakages;
    bq.[55] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([56]) :: leakages;
    bq.[56] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([57]) :: leakages;
    bq.[57] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([58]) :: leakages;
    bq.[58] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([59]) :: leakages;
    bq.[59] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([60]) :: leakages;
    bq.[60] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([61]) :: leakages;
    bq.[61] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([62]) :: leakages;
    bq.[62] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([63]) :: leakages;
    bq.[63] <- aux;
    return (bq);
  }
  
  proc bn_set_ex_w (ex_w:W64.t Array32.t) : W64.t Array32.t = {
    var aux: W64.t;
    
    var tmp:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16079707453520027538);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([0]) :: leakages;
    ex_w.[0] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9896202453426434722);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([1]) :: leakages;
    ex_w.[1] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9734514543779861232);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([2]) :: leakages;
    ex_w.[2] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2720597558662080082);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([3]) :: leakages;
    ex_w.[3] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5422305391744666469);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([4]) :: leakages;
    ex_w.[4] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 6284856943141827897);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([5]) :: leakages;
    ex_w.[5] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3571931755504819832);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([6]) :: leakages;
    ex_w.[6] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8898582908871733242);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([7]) :: leakages;
    ex_w.[7] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1704218965307655612);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([8]) :: leakages;
    ex_w.[8] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13955911167960165174);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([9]) :: leakages;
    ex_w.[9] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1075360349327866006);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([10]) :: leakages;
    ex_w.[10] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15655134966529348674);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([11]) :: leakages;
    ex_w.[11] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13489896038793457581);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([12]) :: leakages;
    ex_w.[12] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9091884461783532811);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([13]) :: leakages;
    ex_w.[13] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14839329871522619038);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([14]) :: leakages;
    ex_w.[14] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2391092563947328990);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([15]) :: leakages;
    ex_w.[15] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8841078175838623648);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([16]) :: leakages;
    ex_w.[16] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8090086859770744697);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([17]) :: leakages;
    ex_w.[17] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9327323138639727608);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([18]) :: leakages;
    ex_w.[18] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15359750175411445414);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([19]) :: leakages;
    ex_w.[19] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 174800848911598037);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([20]) :: leakages;
    ex_w.[20] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9621397252429152621);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([21]) :: leakages;
    ex_w.[21] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10251157532981205438);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([22]) :: leakages;
    ex_w.[22] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 10677669616094657323);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([23]) :: leakages;
    ex_w.[23] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 6940916673274726784);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([24]) :: leakages;
    ex_w.[24] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16707030954547857917);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([25]) :: leakages;
    ex_w.[25] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15997033023376387679);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([26]) :: leakages;
    ex_w.[26] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1915269043270820409);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([27]) :: leakages;
    ex_w.[27] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1075662976884682063);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([28]) :: leakages;
    ex_w.[28] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 4605192895173857279);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([29]) :: leakages;
    ex_w.[29] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 13724566221682937013);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([30]) :: leakages;
    ex_w.[30] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 7741315053003204029);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([31]) :: leakages;
    ex_w.[31] <- aux;
    return (ex_w);
  }
  
  proc bn_set_ex_s (ex_s:W64.t Array32.t) : W64.t Array32.t = {
    var aux: W64.t;
    
    var tmp:W64.t;
    
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 7171969242160550925);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([0]) :: leakages;
    ex_s.[0] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8804781220001203743);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([1]) :: leakages;
    ex_s.[1] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14594497754230940608);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([2]) :: leakages;
    ex_s.[2] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1472392515548218179);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([3]) :: leakages;
    ex_s.[3] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 4948236216193327450);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([4]) :: leakages;
    ex_s.[4] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1031462267516433719);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([5]) :: leakages;
    ex_s.[5] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 4797027940007565550);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([6]) :: leakages;
    ex_s.[6] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16764487674120473874);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([7]) :: leakages;
    ex_s.[7] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 5584558119897651268);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([8]) :: leakages;
    ex_s.[8] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12193031863899618817);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([9]) :: leakages;
    ex_s.[9] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 4105145217697908108);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([10]) :: leakages;
    ex_s.[10] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17298484718723899587);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([11]) :: leakages;
    ex_s.[11] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 14003085206563225236);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([12]) :: leakages;
    ex_s.[12] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 967507600631665215);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([13]) :: leakages;
    ex_s.[13] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 6159932005602028579);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([14]) :: leakages;
    ex_s.[14] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17632204334305376028);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([15]) :: leakages;
    ex_s.[15] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 17465986506102992472);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([16]) :: leakages;
    ex_s.[16] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 8949836227897206741);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([17]) :: leakages;
    ex_s.[17] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 16842327390758156857);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([18]) :: leakages;
    ex_s.[18] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12801704344442488385);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([19]) :: leakages;
    ex_s.[19] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1566856634118248884);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([20]) :: leakages;
    ex_s.[20] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 11454838073351799762);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([21]) :: leakages;
    ex_s.[21] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 12515412700129796283);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([22]) :: leakages;
    ex_s.[22] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 11738035997661530147);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([23]) :: leakages;
    ex_s.[23] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 6509515618992112762);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([24]) :: leakages;
    ex_s.[24] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 4087076476951562775);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([25]) :: leakages;
    ex_s.[25] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 2349864693353382499);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([26]) :: leakages;
    ex_s.[26] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15578039638568120178);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([27]) :: leakages;
    ex_s.[27] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 15424853839367417309);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([28]) :: leakages;
    ex_s.[28] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 3385351981655818438);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([29]) :: leakages;
    ex_s.[29] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 1357657197262854114);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([30]) :: leakages;
    ex_s.[30] <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- (W64.of_int 9959485021998196103);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <- tmp;
    leakages <- LeakAddr([31]) :: leakages;
    ex_s.[31] <- aux;
    return (ex_s);
  }
  
  proc commitment_indexed () : int * W64.t Array32.t * W64.t Array32.t = {
    var aux_1: int;
    var aux: W64.t Array32.t;
    var aux_0: W64.t Array64.t;
    
    var i:int;
    var commitment_0:W64.t Array32.t;
    var secret_power:W64.t Array32.t;
    var exp_order:W64.t Array32.t;
    var group_order:W64.t Array32.t;
    var group_generator:W64.t Array32.t;
    var barrett_parameter:W64.t Array64.t;
    barrett_parameter <- witness;
    commitment_0 <- witness;
    exp_order <- witness;
    group_generator <- witness;
    group_order <- witness;
    secret_power <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_q (exp_order);
    exp_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_p (group_order);
    group_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_g (group_generator);
    group_generator <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ bn_set_bp (barrett_parameter);
    barrett_parameter <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    (aux_1, aux) <@ rsample (exp_order);
    i <- aux_1;
    secret_power <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ expm (barrett_parameter, group_order, group_generator,
    secret_power);
    commitment_0 <- aux;
    return (i, commitment_0, secret_power);
  }
  
  proc commitment () : W64.t Array32.t * W64.t Array32.t = {
    var aux_1: int;
    var aux: W64.t Array32.t;
    var aux_0: W64.t Array64.t;
    
    var commitment_0:W64.t Array32.t;
    var secret_power:W64.t Array32.t;
    var exp_order:W64.t Array32.t;
    var group_order:W64.t Array32.t;
    var group_generator:W64.t Array32.t;
    var barrett_parameter:W64.t Array64.t;
    var  _0:int;
    barrett_parameter <- witness;
    commitment_0 <- witness;
    exp_order <- witness;
    group_generator <- witness;
    group_order <- witness;
    secret_power <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_q (exp_order);
    exp_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_p (group_order);
    group_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_g (group_generator);
    group_generator <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ bn_set_bp (barrett_parameter);
    barrett_parameter <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    (aux_1, aux) <@ rsample (exp_order);
     _0 <- aux_1;
    secret_power <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ expm (barrett_parameter, group_order, group_generator,
    secret_power);
    commitment_0 <- aux;
    return (commitment_0, secret_power);
  }
  
  proc response (witness0:W64.t Array32.t, secret_power:W64.t Array32.t,
                 challenge_0:W64.t Array32.t) : W64.t Array32.t = {
    var aux: W64.t Array32.t;
    var aux_0: W64.t Array64.t;
    
    var response_0:W64.t Array32.t;
    var exp_order:W64.t Array32.t;
    var exp_barrett:W64.t Array64.t;
    var product:W64.t Array32.t;
    exp_barrett <- witness;
    exp_order <- witness;
    product <- witness;
    response_0 <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_q (exp_order);
    exp_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ bn_set_bq (exp_barrett);
    exp_barrett <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_breduce_small (challenge_0, exp_barrett, exp_order);
    challenge_0 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_breduce_small (secret_power, exp_barrett, exp_order);
    secret_power <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_breduce_small (witness0, exp_barrett, exp_order);
    witness0 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ mulm (exp_barrett, exp_order, challenge_0, witness0);
    product <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ addm2 (exp_order, secret_power, product);
    response_0 <- aux;
    return (response_0);
  }
  
  proc challenge_indexed () : int * W64.t Array32.t = {
    var aux_0: int;
    var aux: W64.t Array32.t;
    
    var i:int;
    var challenge_0:W64.t Array32.t;
    var exp_order:W64.t Array32.t;
    challenge_0 <- witness;
    exp_order <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_q (exp_order);
    exp_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux_0, aux) <@ rsample (exp_order);
    i <- aux_0;
    challenge_0 <- aux;
    return (i, challenge_0);
  }
  
  proc challenge () : W64.t Array32.t = {
    var aux_0: int;
    var aux: W64.t Array32.t;
    
    var challenge_0:W64.t Array32.t;
    var exp_order:W64.t Array32.t;
    var  _0:int;
    challenge_0 <- witness;
    exp_order <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_q (exp_order);
    exp_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    (aux_0, aux) <@ rsample (exp_order);
     _0 <- aux_0;
    challenge_0 <- aux;
    return (challenge_0);
  }
  
  proc verify (statement:W64.t Array32.t, commitment_0:W64.t Array32.t,
               challenge_0:W64.t Array32.t, response_0:W64.t Array32.t) : 
  W64.t = {
    var aux_1: W64.t;
    var aux: W64.t Array32.t;
    var aux_0: W64.t Array64.t;
    
    var result1:W64.t;
    var exp_order:W64.t Array32.t;
    var exp_barrett:W64.t Array64.t;
    var group_order:W64.t Array32.t;
    var group_barrett:W64.t Array64.t;
    var group_generator:W64.t Array32.t;
    var tmp:W64.t Array32.t;
    var v1:W64.t Array32.t;
    var v2:W64.t Array32.t;
    var v3:W64.t Array32.t;
    var v4:W64.t Array32.t;
    var result2:W64.t;
    exp_barrett <- witness;
    exp_order <- witness;
    group_barrett <- witness;
    group_generator <- witness;
    group_order <- witness;
    tmp <- witness;
    v1 <- witness;
    v2 <- witness;
    v3 <- witness;
    v4 <- witness;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_q (exp_order);
    exp_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ bn_set_bq (exp_barrett);
    exp_barrett <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_p (group_order);
    group_order <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_0 <@ bn_set_bp (group_barrett);
    group_barrett <- aux_0;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set_g (group_generator);
    group_generator <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_breduce_small (statement, group_barrett, group_order);
    statement <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_breduce_small (commitment_0, group_barrett, group_order);
    commitment_0 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_breduce_small (challenge_0, exp_barrett, exp_order);
    challenge_0 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_breduce_small (response_0, exp_barrett, exp_order);
    response_0 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ expm (group_barrett, group_order, statement, challenge_0);
    tmp <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ mulm (group_barrett, group_order, commitment_0, tmp);
    v1 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ expm (group_barrett, group_order, group_generator, response_0);
    v2 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <@ bn_eq (v1, v2);
    result1 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ expm (group_barrett, group_order, statement, exp_order);
    v3 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux <@ bn_set1 (v4);
    v4 <- aux;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <@ bn_eq (v3, v4);
    result2 <- aux_1;
    leakages <- LeakAddr([]) :: leakages;
    aux_1 <- (result1 `&` result2);
    result1 <- aux_1;
    return (result1);
  }
}.

